<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Velha</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
<style>
        * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Arial', sans-serif;
    }

        body {
            font-family: 'Poppins', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: #fff;
            padding: 20px;
        }

    .container {
    text-align: center;
    }

    h1 {
    font-family: 'Poppins', sans-serif;
    font-size: 2.5rem;
    margin-bottom: 20px;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .board {
    font-family: 'Poppins', sans-serif;
    display: grid;
    grid-template-columns: repeat(3, 100px);
    grid-template-rows: repeat(3, 100px);
    gap: 10px;
    margin: 20px auto;
    }

    .cell {
    font-family: 'Poppins', sans-serif;
    width: 100px;
    height: 100px;
    background-color: rgba(255, 255, 255, 0.1);
    border: 2px solid #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 2rem;
    border-radius: 10px;
    cursor: pointer;
    transition: background-color 0.3s, transform 0.2s;
    }

    .cell:hover {
    background-color: rgba(255, 255, 255, 0.2);
    }

    .cell.X::before {
    content: 'X';
    color: #ff4d4d;
    animation: popIn 0.3s ease-in-out;
    }

    .cell.O::before {
    content: 'O';
    color: #4dff4d;
    animation: popIn 0.3s ease-in-out;
    }

    .status {
    font-family: 'Poppins', sans-serif;
    font-size: 1.5rem;
    margin: 20px 0;
    animation: fadeIn 1s ease-in-out;
    }

    .reset-btn {
    font-family: 'Poppins', sans-serif;
    padding: 10px 20px;
    font-size: 1rem;
    color: #fff;
    background-color: #ff4d4d;
    border: 1px solid #ac1010;
    border-bottom: 3px solid #ac1010;
    border-radius: 10px;
    cursor: pointer;
    transition: background-color 0.3s, transform 0.2s;
    }

    .reset-btn:hover {
    background-color: #ff1a1a;
    }

    @keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
    }

    @keyframes popIn {
    0% {
        transform: scale(0);
    }
    50% {
        transform: scale(1.2);
    }
    100% {
        transform: scale(1);
    }
    }

    .winning-cell {
        background: rgba(126, 255, 35, 0.1);
        border-color: rgb(131, 255, 36);
    }

    .difficulty {
        margin-bottom: 20px;
    }

    .difficulty-btn {
        font-family: 'Poppins', sans-serif;
        padding: 10px 20px;
        margin: 0 5px;
        font-size: 1rem;
        color: #fff;
        background-color: #1e3c72;
        border: 1px solid #13274d;
        border-bottom: 3px solid #13274d;
        border-radius: 11px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    .difficulty-btn:hover {
        background-color: #1a3566;
    }

    .difficulty-btn.active[data-difficulty="easy"] {
        background-color: #28a745;
        border-color: #1e7e34;
    }

    .difficulty-btn.active[data-difficulty="medium"] {
        background-color: #ffc107;
        border-color: #d39e00;
    }

    .difficulty-btn.active[data-difficulty="hard"] {
        background-color: #dc3545;
        border-color: #c82333;
    }

    .difficulty-btn.secret {
        background-color: #20c997 !important;
        border-color: #1aa179 !important;
    }

    #spaceInvaders {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.9);
        display: none;
        z-index: 1000;
    }

    #playerShip {
        position: absolute;
        bottom: 20px;
        left: 50%;
        width: 40px;
        height: 40px;
        background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="%2300ff00" d="M12 2L2 22h20z"/></svg>');
        transform: translateX(-50%);
    }

    .enemyShip {
        position: absolute;
        width: 30px;
        height: 30px;
        background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="%23ff0000"/></svg>');
    }

    .bullet {
        position: absolute;
        width: 4px;
        height: 20px;
        background: #ff0;
    }

    #gameScore {
        position: fixed;
        top: 20px;
        right: 20px;
        color: #fff;
        font-size: 24px;
    }

    .subliminal {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: #0f0;
        font-size: 40px;
        text-shadow: 0 0 10px #0f0;
        display: none;
        animation: subliminal 0.1s 10;
    }

    @keyframes subliminal {
        0% { opacity: 0; }
        50% { opacity: 1; }
        100% { opacity: 0; }
    }

    .mobile-controls {
        display: none;
        position: fixed;
        bottom: 20px;
        left: 0;
        right: 0;
        justify-content: space-between;
        padding: 0 20px;
        touch-action: manipulation;
    }

    .control-btn {
        width: 60px;
        height: 60px;
        background: rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 24px;
        color: white;
        user-select: none;
        -webkit-tap-highlight-color: transparent;
    }

    #shootBtn {
        background: rgba(255, 0, 0, 0.5);
    }
    
</style>
</head>
<body>
<div class="container">
    <h1>JOGO DA VELHA</h1>
    <div class="difficulty">
        <button class="difficulty-btn active" data-difficulty="easy">Fácil</button>
        <button class="difficulty-btn" data-difficulty="medium">Médio</button>
        <button class="difficulty-btn" data-difficulty="hard">Difícil</button>
    </div>
    <div class="board">
        <div class="cell" data-index="0"></div>
        <div class="cell" data-index="1"></div>
        <div class="cell" data-index="2"></div>
        <div class="cell" data-index="3"></div>
        <div class="cell" data-index="4"></div>
        <div class="cell" data-index="5"></div>
        <div class="cell" data-index="6"></div>
        <div class="cell" data-index="7"></div>
        <div class="cell" data-index="8"></div>
    </div>
    <div class="status"></div>
    <button class="reset-btn">Reiniciar</button>
    <div class="mobile-controls">
        <div class="control-btn" id="leftBtn">←</div>
        <div class="control-btn" id="shootBtn">⚡</div>
        <div class="control-btn" id="rightBtn">→</div>
    </div>
</div>
<script>
    const board = document.querySelector('.board');
    const cells = document.querySelectorAll('.cell');
    const statusText = document.querySelector('.status');
    const resetBtn = document.querySelector('.reset-btn');

    let currentPlayer = 'X';
    let gameState = ['', '', '', '', '', '', '', '', ''];
    let gameActive = true;
    let aiDifficulty = 'hard';
    let secretMode = false;
    let clickCount = 0;
    let lastClickTime = 0;
    let moveInterval;
    let moveDirection = 0;

    const winningConditions = [
        [0, 1, 2], [3, 4, 5], [6, 7, 8],
        [0, 3, 6], [1, 4, 7], [2, 5, 8],
        [0, 4, 8], [2, 4, 6]
    ];

const winningCells = (combination) => {
        combination.forEach(index => {
            cells[index].classList.add('winning-cell');
        });
    };

    function handleCellClick(event) {
        if (!gameActive || currentPlayer !== 'X' || event.target.classList.contains('disabled')) return;
        
        const clickedCell = event.target;
        const clickedCellIndex = parseInt(clickedCell.getAttribute('data-index'));

        if (gameState[clickedCellIndex] !== '') return;
        
        gameState[clickedCellIndex] = 'X';
        clickedCell.classList.add('X');
        checkForWinner();
    }

function checkForWinner() {
        let roundWon = false;
        let winningCombination = null;

        for (const condition of winningConditions) {
            const [a, b, c] = condition;
            if (gameState[a] && gameState[a] === gameState[b] && gameState[a] === gameState[c]) {
                roundWon = true;
                winningCombination = condition;
                break;
            }
        }

        if (roundWon) {
            winningCells(winningCombination);
            statusText.textContent = `Vitória de ${currentPlayer}!`;
            gameActive = false;
            return;
        }

        if (!gameState.includes('')) {
            statusText.textContent = 'Empate!';
            gameActive = false;
            return;
        }

        currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
        statusText.textContent = `Vez do jogador ${currentPlayer}`;

        if (gameActive && currentPlayer === 'O') {
            setTimeout(makeAIMove, 500);
        }
    }

    function resetGame() {
        gameState = ['', '', '', '', '', '', '', '', ''];
        gameActive = true;
        currentPlayer = 'X';
        statusText.textContent = `Vez do jogador ${currentPlayer}`;
        cells.forEach(cell => {
            cell.classList.remove('X', 'O', 'winning-cell', 'disabled');
        });
    }

cells.forEach(cell => {
cell.addEventListener('click', handleCellClick);
});

resetBtn.addEventListener('click', resetGame);

statusText.textContent = `Vez do jogador ${currentPlayer}`;

    function easyAI() {
        const emptyCells = gameState.reduce((acc, cell, index) => {
            if (cell === '') acc.push(index);
            return acc;
        }, []);
        return emptyCells[Math.floor(Math.random() * emptyCells.length)];
    }

    function mediumAI() {
        for (const condition of winningConditions) {
            const [a, b, c] = condition;
            if (gameState[a] === 'O' && gameState[a] === gameState[b] && gameState[c] === '') return c;
            if (gameState[a] === 'O' && gameState[c] === 'O' && gameState[b] === '') return b;
            if (gameState[b] === 'O' && gameState[c] === 'O' && gameState[a] === '') return a;
        }
        for (const condition of winningConditions) {
            const [a, b, c] = condition;
            if (gameState[a] === 'X' && gameState[a] === gameState[b] && gameState[c] === '') return c;
            if (gameState[a] === 'X' && gameState[c] === 'X' && gameState[b] === '') return b;
            if (gameState[b] === 'X' && gameState[c] === 'X' && gameState[a] === '') return a;
        }
        return easyAI();
    }

    function minimax(state, depth, isMaximizing) {
        const winner = checkWinner(state);
        if (winner === 'O') return { score: 100 - depth };
        if (winner === 'X') return { score: depth - 100 };
        if (state.every(cell => cell !== '')) return { score: 0 };

        let best = { score: isMaximizing ? -Infinity : Infinity };
        for (let i = 0; i < 9; i++) {
            if (state[i] !== '') continue;
            
            state[i] = isMaximizing ? 'O' : 'X';
            const result = minimax(state, depth + 1, !isMaximizing);
            state[i] = '';

            if (isMaximizing) {
                if (result.score > best.score || 
                   (result.score === best.score && depth % 2 === 0)) {
                    best = { score: result.score, move: i };
                }
            } else {
                if (result.score < best.score || 
                   (result.score === best.score && depth % 2 === 0)) {
                    best = { score: result.score, move: i };
                }
            }
        }
        return best;
    }

    function hardAI() {
        return minimax([...gameState], 0, true).move;
    }

    function checkWinner(state) {
        for (const condition of winningConditions) {
            const [a, b, c] = condition;
            if (state[a] && state[a] === state[b] && state[a] === state[c]) {
                return state[a];
            }
        }
        return null;
    }

    function makeAIMove() {
        if (!gameActive) return;
        
        let move;
        switch (aiDifficulty) {
            case 'easy': move = easyAI(); break;
            case 'medium': move = mediumAI(); break;
            case 'hard': move = hardAI(); break;
        }

        if (gameState[move] === '') {
            gameState[move] = 'O';
            cells[move].classList.add('O');
            checkForWinner();
        }
    }

    document.querySelectorAll('.difficulty-btn').forEach(button => {
        button.addEventListener('click', function() {
            const wasHardActive = document.querySelector('.difficulty-btn[data-difficulty="hard"]').classList.contains('active');
            const isHardButton = this.dataset.difficulty === 'hard';
            
            document.querySelectorAll('.difficulty-btn').forEach(btn => {
                btn.classList.remove('active', 'secret');
            });
            
            this.classList.add('active');
            aiDifficulty = this.dataset.difficulty;
            
            if (isHardButton) {
                if (wasHardActive) {
                    secretMode = !secretMode;
                    this.classList.toggle('secret', secretMode);
                } else {
                    secretMode = false;
                }
            } else {
                secretMode = false;
            }
            
            resetGame();
        });
    });

    function makeAIMove() {
        if (!gameActive) return;
        
        let move;
        if (secretMode && aiDifficulty === 'hard') {
            move = easyAI();
        } else {
            switch (aiDifficulty) {
                case 'easy': move = easyAI(); break;
                case 'medium': move = mediumAI(); break;
                case 'hard': move = hardAI(); break;
            }
        }

        if (gameState[move] === '') {
            gameState[move] = 'O';
            cells[move].classList.add('O');
            checkForWinner();
        }
        
        cells.forEach(c => c.classList.remove('disabled'));
    }

    let devMessageShown = false;

function startSpaceInvaders() {
    document.querySelector('.mobile-controls').style.display = 'flex';
    const container = document.createElement('div');
    container.id = 'spaceInvaders';
    container.innerHTML = `
        <div id="playerShip"></div>
        <div id="gameScore">0</div>
    `;
    document.body.appendChild(container);
    container.style.display = 'block';
    document.querySelector('.container').style.display = 'none';

    let playerX = 50;
    let bullets = [];
    let enemies = [];
    let score = 0;
    let gameActive = true;

    function movePlayer(e) {
        if(!gameActive) return;
        const speed = e.key === 'ArrowLeft' ? -10 : e.key === 'ArrowRight' ? 10 : 0;
        playerX = Math.min(Math.max(playerX + speed, 5), 95);
        document.getElementById('playerShip').style.left = `${playerX}%`;
    }

    function shoot() {
        if(!gameActive) return;
        const bullet = document.createElement('div');
        bullet.className = 'bullet';
        const playerRect = document.getElementById('playerShip').getBoundingClientRect();
        bullet.style.left = `${playerRect.left + 18}px`;
        bullet.style.top = `${playerRect.top - 20}px`;
        container.appendChild(bullet);
        bullets.push(bullet);
    }

    function spawnEnemy() {
        if(!gameActive) return;
        const enemy = document.createElement('div');
        enemy.className = 'enemyShip';
        enemy.style.left = `${Math.random() * 90}%`;
        enemy.style.top = '10%';
        container.appendChild(enemy);
        enemies.push({
            element: enemy,
            x: parseFloat(enemy.style.left),
            dir: Math.random() > 0.5 ? 1 : -1
        });
    }

    function checkCollision(bullet, enemy) {
        const bRect = bullet.getBoundingClientRect();
        const eRect = enemy.getBoundingClientRect();
        return !(bRect.right < eRect.left || 
               bRect.left > eRect.right || 
               bRect.bottom < eRect.top || 
               bRect.top > eRect.bottom);
    }

    function gameLoop() {
        if(!gameActive) return;

        bullets.forEach((bullet, index) => {
            const top = parseFloat(bullet.style.top) || window.innerHeight;
            if(top < 0) {
                bullet.remove();
                bullets.splice(index, 1);
            } else {
                bullet.style.top = `${top - 10}px`;
            }
        });

        enemies.forEach((enemy, index) => {
            enemy.x += enemy.dir;
            if(enemy.x > 90 || enemy.x < 0) enemy.dir *= -1;
            enemy.element.style.left = `${enemy.x}%`;

            bullets.forEach((bullet, bIndex) => {
                if(checkCollision(bullet, enemy.element)) {
                    enemy.element.remove();
                    bullet.remove();
                    enemies.splice(index, 1);
                    bullets.splice(bIndex, 1);
                    score++;
                    document.getElementById('gameScore').textContent = score;

                    if(score >= 15 && !devMessageShown) {
                        showSubliminalMessage();
                        devMessageShown = true;
                        gameActive = false;
                    }
                }
            });
        });

        requestAnimationFrame(gameLoop);
    }

    function showSubliminalMessage() {
        const msg = document.createElement('div');
        msg.className = 'subliminal';
        msg.textContent = 'DEV TEAM: VF, JP, MC';
        container.appendChild(msg);
        msg.style.display = 'block';

        setTimeout(() => {
            container.remove();
            document.querySelector('.container').style.display = 'block';
        }, 2000);

        setTimeout(() => {
            container.remove();
            document.querySelector('.container').style.display = 'block';
            document.querySelector('.mobile-controls').style.display = 'none';
            gameActive = false;
    }, 2000);
    }

    document.addEventListener('keydown', (e) => {
        if(['ArrowLeft', 'ArrowRight'].includes(e.key)) movePlayer(e);
        if(e.code === 'Space') shoot();
    });

    setInterval(spawnEnemy, 2000);
    gameLoop();
}

document.querySelector('h1').addEventListener('click', () => {
    clickCount++;
    if(clickCount === 3) {
        clickCount = 0;
        startSpaceInvaders();
    }
    setTimeout(() => clickCount = 0, 1000);
});

function startMove(direction) {
    moveDirection = direction;
    moveInterval = setInterval(() => {
        if(!gameActive) return;
        playerX = Math.min(Math.max(playerX + (direction * 5), 5, 95));
        document.getElementById('playerShip').style.left = `${playerX}%`;
    }, 50);
}

function stopMove() {
    clearInterval(moveInterval);
    moveDirection = 0;
}

document.querySelector('#leftBtn').addEventListener('touchstart', (e) => {
    e.preventDefault();
    startMove(-1);
});
document.querySelector('#rightBtn').addEventListener('touchstart', (e) => {
    e.preventDefault();
    startMove(1);
});
document.querySelector('#leftBtn').addEventListener('touchend', stopMove);
document.querySelector('#rightBtn').addEventListener('touchend', stopMove);
document.querySelector('#shootBtn').addEventListener('touchstart', (e) => {
    e.preventDefault();
    shoot();
});

container.addEventListener('click', () => {
    if(score >= 15 || !gameActive) {
        container.remove();
        document.querySelector('.container').style.display = 'block';
        document.querySelector('.mobile-controls').style.display = 'none';
        gameActive = false;
    }
});

resetBtn.addEventListener('click', () => {
    resetGame();
    document.querySelector('.mobile-controls').style.display = 'none';
});

    resetGame();
</script>
</body>
</html>
